### Hello 서블릿

<br/>

스프링 부트 환경에서 서블릿을 등록하고 사용해보자.

+) 서블릿은 톰캣 같은 WAS를 직접 설치하지 않고, 따로 설치한 WAS 위에 서블릿 코드를 클래스 파일로 빌드해서 올린 다음, <br/>
톰캣 서버를 실행한다. 하지만 이 과정은 매우 번거롭다. <br/>
스프링 부트는 톰캣 서버를 내장하고 있으므로, 톰캣 서버 설치 없이 편리하게 서블릿 코드를 실행할 수 있다.

스프링 부트는 서블릿을 직접 등록해서 사용할 수 있도록 @ServletComponentScan을 지원한다. 다음과 같이 추가하자.

- ServletApplication.java

```java

@ServletComponentScan //서블릿 자동 등록
@SpringBootApplication
public class ServletApplication {

	public static void main(String[] args) {
		SpringApplication.run(ServletApplication.class, args);
	}

}

```

<br/>

**<서블릿 등록하기>**

실제 동작하는 서블릿 코드를 등록해보자.

- basic/HelloServlet.java

```java

@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        System.out.println("HelloServlet.service");
        System.out.println("request = " + request);
        System.out.println("response = " + response);

        String username = request.getParameter("username");
        System.out.println("username = " + username);

        response.setContentType("text/plain");
        response.setCharacterEncoding("utf-8");
        response.getWriter().write("hello " + username);
    }
}


```

웹 브라우저 실행 -> http://localhost:8080/hello?username=kim

-> 결과 (화면출력)<br/>

hello kim

-> 콘솔 실행결과

HelloServlet.service <br/>
request = org.apache.catalina.connector.RequestFacade@5e4e72 <br/>
response = org.apache.catalina.connector.ResponseFacade@37d112b6 <br/>
username = kim <br/>

 
HTTP 메시지를 직접 파싱할 필요 없이 request, response를 사용해서 편리하게 메시지에 필요한 부분을 작성할 수 있다.


<br/>

**<서블릿 컨테이너 동작 방식>**

![image](https://user-images.githubusercontent.com/78454649/165231649-b52ac497-9238-4241-ad34-aab6c01b5bab.png)

1. 웹 브라우저가 /hello URL 호출
2. HTTP 요청 메시지가 생성되고 서버에 요청
3. 톰캣 서버는 request, response 객체를 자동 생성하고 서블릿 컨테이너에 등록된 helloServlet 객체를 실행
4. 개발자가 직접 짠 service 로직을 수행
5. response 객체를 기반으로 HTTP 응답 메시지를 웹 브라우저에 전송

![image](https://user-images.githubusercontent.com/78454649/165231799-85997a43-4aff-458a-901c-664060bad112.png)

+) 참고 : HTTP 응답에서 Content-Length는 WAS가 자동으로 생성해준다.

<br/>

---

### HttpServletRequest - 개요

<br/>

<HttpServletRequest 역할>

HTTP 요청 메시지를 개발자가 직접 파싱해서 사용해도 되지만, 매우 불편할 것이다.  <br/>
서블릿은 개발자가 HTTP 요청 메시지를 편리하게 사용할 수 있도록 개발자 대신에 HTTP 요청 메시지를 파싱한다.  <br/>
그리고 그 결과를 HttpServletRequest 객체에 담아서 제공한다.

HttpServletRequest를 사용하면 다음과 같은 HTTP 요청 메시지를 편리하게 조회할 수 있다.

```java

POST /save HTTP/1.1 -> START LINE
Host: localhost:8080

Content-Type: application/x-www-form-urlencoded -> 헤더

 

username=kim&age=20 -> 바디

```

START LINE : HTTP 메소드, URL, 쿼리 스트링, 버전 등 조회 <br/>
헤더 : 헤더 조회 <br/>
바디 : HTML form 파라미터 형식 조회, JSON과 같은 데이터 직접 조회 <br/>
(JSON을 직접 조회하려면 라이브러리가 추가로 필요한데 이는 뒤에서 다루겠다.)

<br/>


HttpServletRequest 객체는 추가로 여러가지 부가 기능도 함께 제공한다.

임시 저장소 기능 : 해당 HTTP 요청이 시작부터 끝날 때까지 유지되는 임시 저장소 기능 <br/>
-> 저장 : request.setAttribute(name, value) <br/>
-> 요청 : : request.getAttribute(name) <br/>


세션 관리 기능 : request.getSession(create: true)

<br/>

---

### HttpServletRequest - 기본 사용법




















